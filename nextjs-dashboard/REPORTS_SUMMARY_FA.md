# ุฎูุงุตู ุงุฌุฑุง ฺฏุฒุงุฑุดโูุง

## โ ฺฉุงุฑ ุงูุฌุงู ุดุฏู

ุณู ฺฏุฒุงุฑุด ุชุญูู ุฌุฏุฏ ุณุงุฎุชู ู ฺฉูพุงุฑฺู ุดุฏูโุงูุฏ:

### 1๏ธโฃ **ฺฏุฒุงุฑุด ุธุฑูุช ูุถุงูุง** (`/reports/capacity`)
- **ูุฏู**: ููุงุด ุฏุฑุตุฏ ุงุณุชูุงุฏู ุงุฒ ุธุฑูุช ุณุงูู ุจุฑุง ูุฑ ุงูุชุญุงู
- **ูฺฺฏโูุง**:
  - ุงูุชุฎุงุจ ุชุฑู ุงุฒ dropdown
  - ุฌุฏูู ุงูุชุญุงูุงุช ุจุง ุณุชููโูุง: ูุงู ุงูุชุญุงูุ ุชุนุฏุงุฏ ุฏุงูุดุฌูุ ุณุงูู ุงุฎุชุตุงุตุ ุธุฑูุชุ ุฏุฑุตุฏ ุงุณุชูุงุฏู
  - ููุงุด ูุดุฏุงุฑ:
    - **ูุฑูุฒ** (ุชุฌุงูุฒ ุธุฑูุช): ุงฺฏุฑ ุฏุงูุดุฌูุงู > ุธุฑูุช ุณุงูู (>100%)
    - **ุฒุฑุฏ** (ฺฉูโุชุฑ ุงุฒ 30%): ุงฺฏุฑ ุณุงูู ุฒุฑ 30% ุงุณุชูุงุฏู ุดูุฏ
  - ูุฑุชุจโุณุงุฒ ุฎูุฏฺฉุงุฑ ุงุฒ ุจุดุชุฑู ุชุง ฺฉูุชุฑู ุงุณุชูุงุฏู
  - ูพุดุชุจุงู Dark Mode

### 2๏ธโฃ **ฺฏุฒุงุฑุด ุชุฏุงุฎูโูุง** (`/reports/conflicts`)
- **ูุฏู**: ุดูุงุณุง ุจุฑุฎูุฑุฏโูุง ุฒูุงูโุจูุฏ (ุงูุชุญุงูุงุช ฺฉู ุฏุฑ ฺฉ ุณุงูู ู ฺฉ ุณุงุนุช ูุฑุงุฑ ุฏุงุฑูุฏ)
- **ูฺฺฏโูุง**:
  - ุงูุชุฎุงุจ ุชุฑู
  - ุชุดุฎุต ุฎูุฏฺฉุงุฑ ุชุฏุงุฎูโูุง ุฒูุงู:
    - ููุชุฑ: ฺฉ ุณุงูู + ฺฉ ุฑูุฒ + ุชูุงุทุน ุณุงุนุชโูุง
  - ุดูุงุณุง ุงุฎุชุตุงุตโูุง ุฏุณุช (ุจุง ูุดุงููโูุง: `created_manually`, `is_manual`, `source`, `created_by`, etc)
  - ุณุน ุจุฑุง ุฏุฑุงูุช ูุงฺฏโูุง ุชุบุฑุงุช ุงุฒ API (fallback graceful)
  - ููุงุด ฺฏุฑููโุจูุฏ ุดุฏู: ูุฑ ุชุฏุงุฎู = ฺฉ ฺฉุงุฑุช ุณุงูู+ุฑูุฒ โ ุฏุงุฎู ุขู ูุฑ allocation
  - ูพุฑฺู ุฒุฑุฏ ุจุฑุง ุงุฎุชุตุงุตโูุง ุฏุณุช

### 3๏ธโฃ **ฺฏุฒุงุฑุด ุงุณุชูุงุฏู ุงุฒ ูฺฉุงูโูุง** (`/reports/utilization`)
- **ูุฏู**: ุชุญูู ุจุงุฑ ฺฉุงุฑ ุณุงููโูุง ู ุณุงุนุงุช ูพุฑุชุฑุงู
- **ูฺฺฏโูุง**:
  - ุงูุชุฎุงุจ ุชุฑู
  - **ูููุฏุงุฑ ูููโุง** (ุจุงุฑ ฺฉุงุฑ):
    - ุฑูฺฏโฺฉุฏฺฏุฐุงุฑ: ุณุจุฒ (<50%), ุฒุฑุฏ (50-80%), ูุฑูุฒ (>80%)
    - ุนุฑุถ ููู ูุณุจ ุจุฑ ุงุณุงุณ ุจุงูุงุชุฑู ุงุณุชูุงุฏู
    - ููุงุด ุฏุฑุตุฏ ูุณุท ููู ู ุชุนุฏุงุฏ ุงูุชุญุงูุงุช
  - **ุฌุฏูู ุฌุฒุฆุงุช**:
    - ุณุชููโูุง: ูุงู ุณุงูู | ุชุนุฏุงุฏ ุงูุชุญุงูุงุช | ุฏุฑุตุฏ ุงุณุชูุงุฏู | ุณุงุนุงุช ุฎุงู (ุชูุฑุจ) | ุณุงุนุงุช ูพุฑุชุฑุงู
    - ูุฑุชุจโุณุงุฒ: ุงุฒ ุจุดุชุฑู ุชุง ฺฉูุชุฑู ุงุณุชูุงุฏู
  - ูุญุงุณุจู ุงุณุชูุงุฏู:
    - ูุฑุถ: ูุฑ ุงูุชุญุงู 2 ุณุงุนุชุ 80 ุฑูุฒ ฺฉุงุฑ ร 10 ุณุงุนุช/ุฑูุฒ = 800 ุณุงุนุช ุฏุณุชุฑุณโูพุฐุฑ
    - ุฏุฑุตุฏ = (ุณุงุนุงุช ุงุฎุชุตุงุต ุงูุชู / 800) ร 100
  - ุณุงุนุงุช ูพุฑุชุฑุงู: 3 ุณุงุนุช ฺฉู ุจุดุชุฑู ุชุนุฏุงุฏ ุงูุชุญุงู ุฏุงุฑูุฏ

## ๐ง ุงุตูุงุญุงุช ุงูุฌุงู ุดุฏู

### ุชุซุจุช ุตูุญู conflicts
- **ูุณุฆูู**: ุงุฒ `getAllocations()` ุงุณุชูุงุฏู ูโฺฉุฑุฏ (ุชูุงู allocations ุจุฏูู ููุชุฑ)
- **ุญู**: ุชุบุฑ ุจู `getAllocationsForExams()` ุจุฑุง ุฏุฑุงูุช ููุท allocations ุงูุชุญุงูุงุช ุชุฑู ุงูุชุฎุงุจโุดุฏู
- **ูุชุฌู**: ุจูุชุฑ ฺฉุงุฑุง ู ุฏุงุฏูโูุง ุตุญุญโุชุฑ

## ๐ ฺฉูพุงุฑฺฺฏ ุจุง ุตูุญู ุงุตู

ุตูุญู ุงุตู (`/page.tsx`) ุงฺฉููู 8 ุณุฑูุณ ุฏุงุฑุฏ:
```
Dashboard Services:
โโโ ูุฏุฑุช ุงูุชุญุงูุงุช โ /exams
โโโ ูุงุฑุฏ/ุตุงุฏุฑ ฺฉุฑุฏู ุงูุชุญุงูุงุช โ /exams/import-export
โโโ ูุฏุฑุช ุชุฑูโูุง โ /terms
โโโ ูุฏุฑุช ูฺฉุงูโูุง โ /rooms
โโโ ฺฏุฒุงุฑุด ุจุฑูุงูู ุงูุชุญุงูุงุช โ /reports/schedule
โโโ ฺฏุฒุงุฑุด ุธุฑูุช ูุถุงูุง โ /reports/capacity โจ
โโโ ฺฏุฒุงุฑุด ุชุฏุงุฎูโูุง โ /reports/conflicts โจ
โโโ ฺฏุฒุงุฑุด ุงุณุชูุงุฏู ุงุฒ ูฺฉุงูโูุง โ /reports/utilization โจ
```

## ๐ ุงุชุตุงู ุจู API

ุชูุงู ฺฏุฒุงุฑุดโูุง ุงุฒ ุณุฑูุณโูุง ููุฌูุฏ ุงุณุชูุงุฏู ูโฺฉููุฏ:

```typescript
// Terms
import { getTerms } from '@/app/lib/terms-service'

// Exams (with optional term filter)
import { getExams } from '@/app/lib/exams-service'

// Allocations (batch fetching for exams)
import { getAllocationsForExams } from '@/app/lib/allocations-service'

// Rooms
import { getRooms } from '@/app/lib/rooms-service'
```

### ููุงุท ูพุงุงู API:
- `GET /api/terms/` - ุชูุงู ุชุฑูโูุง
- `GET /api/exams/?term={id}` - ุงูุชุญุงูุงุช ฺฉ ุชุฑู
- `GET /api/allocations/` - ุชูุงู ุงุฎุชุตุงุตโูุง
- `GET /api/rooms/` - ุชูุงู ุณุงููโูุง
- `GET /api/allocations/logs/` (Optional) - ูุงฺฏโูุง ุชุบุฑุงุช

## ๐ ุงุญุฑุงุฒ ููุช

ุชูุงู ุฏุฑุฎูุงุณุชโูุง API ุงุฒ header ุงุณุชูุงุฏู ูโฺฉููุฏ:
```
Authorization: Bearer {localStorage.accessToken}
```

**ููู**: ุจุฏูู ุชูฺฉู ููุซุฑ ุฏุฑ `localStorage.accessToken`ุ ุฏุงุฏูโูุง ุจุงุฑ ููโุดููุฏ.

## ๐จ ุงุณุชุงู ู ุชุงุฑฺฉโูพูุด

- ุชูุงู ุตูุญุงุช Tailwind CSS ุงุณุชูุงุฏู ูโฺฉููุฏ
- ุญูุงุช ฺฉุงูู Dark Mode ุจุง ฺฉูุงุณโูุง `dark:`
- ุฑุงุจุท ุณูุช ุฑุงุณุช (`dir="rtl"`) ุจุฑุง ููุงุด ุตุญุญ ูุงุฑุณ
- ุฑูฺฏโฺฉุฏฺฏุฐุงุฑ ุณูุงุฑุด ุจุฑุง ูุดุฏุงุฑูุง ู ูุดุงููโูุง

## โจ ููุงุท ุจุฑุฌุณุชู ูู

### 1. ุชุญูู ุชูุงุทุน ุฒูุงูโูุง
```typescript
function timesOverlap(s1?, e1?, s2?, e2?) {
  const defaultMs = 2 * 60 * 60 * 1000; // 2 hours
  const end1 = e1 ?? new Date(s1.getTime() + defaultMs);
  const end2 = e2 ?? new Date(s2.getTime() + defaultMs);
  return s1 < end2 && s2 < end1;
}
```

### 2. ูพุงุฑุณูฺฏ ุชุงุฑุฎโูุง ุงูุนุทุงูโูพุฐุฑ
```typescript
// Allocation.start_at ูโุชูุงูุฏ:
// - ISO string: "2024-01-15T09:00:00Z"
// - Object: { iso: "...", jalali: "..." }
// - Fallback: date + time fields
```

### 3. ูุญุงุณุจู ุณุงุฒฺฏุงุฑ ุงุณุชูุงุฏู
```typescript
// 800 ุณุงุนุช = 80 ุฑูุฒ ร 10 ุณุงุนุช/ุฑูุฒ (ุณุงุนุงุช ฺฉุงุฑ ุงุณุชุงูุฏุงุฑุฏ)
const totalAvailableHours = 80 * 10;
const usagePercent = (totalAllocatedHours / totalAvailableHours) * 100;
```

## ๐ ูุชุฌูโฺฏุฑ

ุณุณุชู ฺฏุฒุงุฑุดโุณุงุฒ ฺฉุงูู ู ูุนุงู ุงุณุช. ุจุฑุง ููุงุด ุฏุงุฏูโูุง:

### โ ูุงุฒูุงุช:
1. **ูุงฺฏู** - ุจุงุฏ ุชูฺฉู ุฏุฑ localStorage ููุฌูุฏ ุจุงุดุฏ
2. **ุณุฑูุฑ** - `pnpm dev` ุจุงุฏ ุฏุฑุญุงู ุงุฌุฑุง ุจุงุดุฏ
3. **ุฏุงุฏูโูุง** - ุญุฏุงูู ฺฉ ุชุฑูุ ุงูุชุญุงูุ ุณุงูู ู ุงุฎุชุตุงุต ุฏุฑ API

### โ ุชุณุช:
```bash
# Terminal 1: Start dev server
cd nextjs-dashboard && pnpm dev

# Terminal 2: Login (if needed)
# Navigate to /login and authenticate

# Browser: Visit reports
http://localhost:3000/reports/capacity
http://localhost:3000/reports/conflicts
http://localhost:3000/reports/utilization
```

## ๐ ูุงูโูุง ุงุฌุงุฏุดุฏู/ุชุนุฏูโุดุฏู:

```
โจ ูู:
app/reports/capacity/page.tsx (209 lines)
app/reports/conflicts/page.tsx (271 lines) 
app/reports/utilization/page.tsx (240 lines)

๐ ุชุนุฏูโุดุฏู:
app/page.tsx (ุงุถุงูู 1 ุณุฑูุณ ุฌุฏุฏ)

๐ ุฑุงูููุง:
REPORTS_SETUP_GUIDE.md (ุฑุงูููุง ุชูุตู)
```

---

**ูุถุนุช**: โ ุขูุงุฏู ูพุฑูุฏุงฺฉุดู
**ุฎุทุงูุง ฺฉุงููพุงู**: 0
**ุชุตุงุฏูุงุช**: 0
