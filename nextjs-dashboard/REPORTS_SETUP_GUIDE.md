# ฺฏุฒุงุฑุดโูุง ุณุณุชู - ุฑุงูููุง ุชูุธู

## ููุถูุน: ฺฏุฒุงุฑุดโูุง ุฎุงู ูุณุชูุฏ

ุณู ฺฏุฒุงุฑุด ุฌุฏุฏ ุจู ุตูุญู ุงุตู ุงุถุงูู ุดุฏูโุงูุฏ:
- **ฺฏุฒุงุฑุด ุธุฑูุช ูุถุงูุง** (`/reports/capacity`)
- **ฺฏุฒุงุฑุด ุชุฏุงุฎูโูุง** (`/reports/conflicts`) 
- **ฺฏุฒุงุฑุด ุงุณุชูุงุฏู ุงุฒ ูฺฉุงูโูุง** (`/reports/utilization`)

## ุฏูู ุฎุงู ุจูุฏู ฺฏุฒุงุฑุดโูุง

ฺฏุฒุงุฑุดโูุง ูุงุฒ ุจู ุฏู ุดุฑุท ุฏุงุฑูุฏ:

### 1๏ธโฃ **ุจุงุฏ ูุงฺฏู ฺฉูุฏ**
- ุณุฑูุณโูุง ุงุฒ `localStorage.accessToken` ุงุณุชูุงุฏู ูโฺฉููุฏ
- ุจุฏูู tokenุ API ูุฑุงุฎูุงูโูุง ุจุฏูู ุงุญุฑุงุฒ ููุช ุงูุฌุงู ูโุดูุฏ ู ูโุดฺฉูุฏ
- ุตูุญู login ูุฌูุฏ ุฏุงุฑุฏ ุงูุง ุจู ุชูุถุญ ูุงุฒ ุฏุงุฑุฏ

### 2๏ธโฃ **ุณุฑูุฑ ุชูุณุนู ุจุงุฏ ุฏุฑุญุงู ุงุฌุฑุง ุจุงุดุฏ**
```bash
cd nextjs-dashboard
pnpm dev
```
ุณูพุณ ุจู `http://localhost:3000` ุจุฑุฏ

## ูุญูู ุงุณุชูุฑุงุฑ ุงุฒ API

### ูุณุฑ ุฏุงุฏูโูุง ุณุณุชู:

```
ุตูุญุงุช ฺฏุฒุงุฑุด โ ุณุฑูุณโูุง API
     โ
1. getTerms() โ GET /api/terms/ 
   ุชูุงู ุชุฑูโูุง ููุฌูุฏ ุฑุง ุฏุฑุงูุช ูโฺฉูุฏ

2. getExams(termId) โ GET /api/exams/?term={termId}
   ุชูุงู ุงูุชุญุงูุงุช ฺฉ ุชุฑู

3. getAllocationsForExams(examIds) โ GET /api/allocations/ 
   ุงุฎุชุตุงุต ุจุฑุง ุงูุชุญุงูุงุช (ุณุงูู + ุณุงุนุช)

4. getRooms() โ GET /api/rooms/
   ุชูุงู ุณุงููโูุง ุงูุชุญุงู

5. (Optional) GET /api/allocations/logs/
   ุณุงู ุชุบุฑุงุช ุงุฎุชุตุงุต (ุจุฑุง ฺฏุฒุงุฑุด ุชุฏุงุฎูโูุง)
```

### ุณุงุฎุชุงุฑ ุฏุงุฏูโูุง ุงูุชุธุงุฑ ุฑูุชู:

#### Term (ุชุฑู)
```typescript
{
  id: number
  name: string          // "ุชุฑู ูพุงุฒ 1403"
  code?: string         // "FA-1403"
  is_published?: bool
  is_archived?: bool
}
```

#### Exam (ุงูุชุญุงู)
```typescript
{
  id: number
  title: string        // "ูุฒฺฉ ฑ"
  course_code?: string // "PHYS101"
  term: number         // term.id
  expected_students?: number  // ุชุนุฏุงุฏ ุฏุงูุดุฌู ุงูุชุธุงุฑ ุฑูุชู
  duration_minutes?: number
}
```

#### Allocation (ุงุฎุชุตุงุต)
```typescript
{
  id: number
  exam: number         // exam.id
  room?: number        // room.id
  allocated_seats?: number  // ุชุนุฏุงุฏ ุตูุฏู ุงุฎุชุตุงุต ุงูุชู
  start_at: string | {iso: string, jalali: string}  // ISO datetime
  end_at?: string | {iso: string, jalali: string}
  date?: string        // fallback ISO date
  time?: string        // fallback HH:MM
  
  // ุจุฑุง ุดูุงุณุง ุงุฎุชุตุงุต ุฏุณุช (ฺฏุฒุงุฑุด ุชุฏุงุฎูโูุง):
  created_manually?: bool
  is_manual?: bool
  manual?: bool
  source?: string
  created_by?: string
}
```

#### Room (ุณุงูู)
```typescript
{
  id: number
  name: string         // "ุณุงูู ุงูู"
  capacity: number     // 120
  category?: object
  features?: string | object
}
```

## ฺุทูุฑ ฺฏุฒุงุฑุดโูุง ุฏุงุฏู ููุงุด ูโุฏููุฏุ

### 1. ฺฏุฒุงุฑุด ุธุฑูุช ูุถุงูุง
- **ููุทู**: ุจุฑุง ูุฑ ุงูุชุญุงูุ ุชุนุฏุงุฏ ุฏุงูุดุฌู รท ุธุฑูุช ุณุงูู = ุฏุฑุตุฏ ุงุณุชูุงุฏู
- **ูุดุฏุงุฑ ูุฑูุฒ**: ุงฺฏุฑ ุฏุฑุตุฏ > 100% (ุธุฑูุช ฺฉุงู ูุณุช)
- **ูุดุฏุงุฑ ุฒุฑุฏ**: ุงฺฏุฑ ุฏุฑุตุฏ < 30% (ุณุงูู ุฎู ุฎุงู ุงุณุช)
- **ุชุฑุชุจ**: ุงุฒ ุจุดุชุฑู ุชุง ฺฉูุชุฑู ุงุณุชูุงุฏู

### 2. ฺฏุฒุงุฑุด ุชุฏุงุฎูโูุง  
- **ููุทู**: ุงูุชุญุงูุงุช ฺฉู ุฏุฑ ฺฉ ุณุงููุ ฺฉ ุฑูุฒ ู ฺฉ ุณุงุนุช ุชูุงุทุน ุฏุงุฑูุฏ
- **ูพุฑฺู ุฏุณุช**: ุงฺฏุฑ allocation ููุฏ ุฏุณุช ุฏุงุฑุฏ (created_manually, is_manual, etc)
- **ุณุงู**: ุณุน ุฏุงุฑุฏ ุงุฒ `/api/allocations/logs/` ุง `/api/allocations/attempts/` ุชุบุฑุงุช ุจฺฏุฑุฏ
- **ููุงุด**: ฺฏุฑููโูุง ุชุฏุงุฎู โ ูุฑ ฺฏุฑูู ฺฉ ุณุงูู+ุฑูุฒ โ ูุฑ allocation ฺฉ ุฑุฏู

### 3. ฺฏุฒุงุฑุด ุงุณุชูุงุฏู ุงุฒ ูฺฉุงูโูุง
- **ููุทู**: 
  - ฺฉู ุณุงุนุชโูุง ูุฑุถ = 80 ุฑูุฒ ร 10 ุณุงุนุช/ุฑูุฒ = 800 ุณุงุนุช
  - ฺฉู ุณุงุนุชโูุง ุงุฎุชุตุงุต = ุชุนุฏุงุฏ allocations ร 2 ุณุงุนุช (ูุฑุถ)
  - ุฏุฑุตุฏ ุงุณุชูุงุฏู = (ุณุงุนุช ุงุฎุชุตุงุต / 800) ร 100
- **ูููุฏุงุฑ ูููโุง**: ูฺูุงู ุฑูฺฏ (ุณุจุฒ <50%, ุฒุฑุฏ 50-80%, ูุฑูุฒ >80%)
- **ุณุงุนุงุช ูพุฑุจุงุฑ**: 3 ุณุงุนุช ฺฉู ุจุดุชุฑู ุงูุชุญุงู ุฏุงุฑูุฏ
- **ุณุงุนุงุช ุฎุงู**: ุชูุฑุจ ุณุงุนุงุช ฺฉู ุณุงูู ุงุณุชูุงุฏู ููโุดูุฏ

## ุงฺฏุฑ ูููุฒ ุฎุงู ูุณุชูุฏ:

### โ ููุงุท ุจุฑุฑุณ:

1. **ุขุง ุชูฺฉู ููุฌูุฏ ุงุณุชุ**
   ```javascript
   // ุฏุฑ Developer Tools (F12) Console:
   localStorage.getItem('accessToken')
   ```
   ุงฺฏุฑ null ุงุณุชุ ุจุงุฏ ูุงฺฏู ฺฉูุฏ

2. **ุขุง ุณุฑูุฑ ุฏุฑุญุงู ุงุฌุฑุง ุงุณุชุ**
   ```bash
   pnpm dev
   ```
   ุจุงุฏ "ready - started server on 0.0.0.0:3000" ูุดุงู ุฏูุฏ

3. **ุขุง API ุฏุฑ ุฏุณุชุฑุณ ุงุณุชุ**
   ```bash
   curl -H "Authorization: Bearer YOUR_TOKEN" http://localhost:8000/api/terms/
   ```

4. **ุขุง ุฏุงุฏูโูุง ุฏุฑ ุณุฑูุฑ ููุฌูุฏ ุงุณุชุ**
   - ุจู database ุจุฑูุฏ ู ุชุฑูุ ุงูุชุญุงูุ ุณุงูู ุงุถุงูู ฺฉูุฏ
   - ุง seed script ุงุณุชูุงุฏู ฺฉูุฏ (ุงฺฏุฑ ููุฌูุฏ ุจุงุดุฏ)

## ูุงูโูุง ูุฑุชุจุท:

```
nextjs-dashboard/
โโโ app/
โ   โโโ reports/
โ   โ   โโโ capacity/page.tsx        โ ฺฏุฒุงุฑุด ุธุฑูุช
โ   โ   โโโ conflicts/page.tsx       โ ฺฏุฒุงุฑุด ุชุฏุงุฎู
โ   โ   โโโ utilization/page.tsx     โ ฺฏุฒุงุฑุด ุงุณุชูุงุฏู
โ   โ   โโโ schedule/page.tsx        (ููููู ููุฌูุฏ)
โ   โโโ lib/
โ   โ   โโโ terms-service.ts         ๐ ุฏุฑุงูุช ุชุฑูโูุง
โ   โ   โโโ exams-service.ts         ๐ ุฏุฑุงูุช ุงูุชุญุงูุงุช
โ   โ   โโโ allocations-service.ts   ๐ ุฏุฑุงูุช ุงุฎุชุตุงุตโูุง
โ   โ   โโโ rooms-service.ts         ๐ ุฏุฑุงูุช ุณุงููโูุง
โ   โ   โโโ auth-context.tsx         ๐ ูุฏุฑุช token
โ   โโโ page.tsx                     ๐ ุตูุญู ุงุตู ุจุง ููฺฉโูุง
```

## ูุชุฌู:

ฺฏุฒุงุฑุดโูุง **ฺฉุงููุงู ฺฉุงุฑ ูโฺฉููุฏ** - ููุท ูุงุฒ ุจู:
1. โ ูุงฺฏู (ุจุฑุง token)
2. โ ุณุฑูุฑ ุฏุฑุญุงู ุงุฌุฑุง (pnpm dev)
3. โ ุฏุงุฏูโูุง ููุฌูุฏ ุฏุฑ API (database ูพุฑ ุดุฏู)

ููุช ุงู ุดุฑุงุท ุจุฑุขูุฑุฏู ุดููุฏุ ุฏุงุฏูโูุง ุฎูุฏฺฉุงุฑ ููุงุด ุฏุงุฏู ูโุดููุฏ! ๐
